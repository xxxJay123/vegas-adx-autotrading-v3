# ======================================
# VEGAS ADX BACKTESTING CONFIGURATION
# OPTIMIZED VERSION - Target: +20% Annual Return
# ======================================

# -------------------- DATA SOURCE CONFIGURATION --------------------
# DATA_SOURCE: Choose data source - "csv" or "binance"
# - csv: Load data from CSV files in DATA_DIR
# - binance: Download data directly from Binance API
DATA_SOURCE=binance

# TIMEFRAMES: Comma-separated list of timeframes to backtest
# Examples: 5m, 15m, 30m, 1h, 4h, 1d
# Multiple timeframes: TIMEFRAMES=5m,15m,1h
TIMEFRAMES=5m

# -------------------- DATA PATHS --------------------
DATA_DIR=./data/kline
REPORTS_DIR=./data/reports

# -------------------- BINANCE API CONFIGURATION --------------------
# Required only when DATA_SOURCE=binance
# For public data (klines), API key is optional but recommended to avoid rate limits
BINANCE_API_KEY=
BINANCE_SECRET_KEY=

# Trading symbol (e.g., BTCUSDT, ETHUSDT, SOLUSDT)
BINANCE_SYMBOL=BTCUSDT

# Date range for historical data
# Format: YYYY-MM-DD or leave empty for all available data
# Examples: 2024-01-01, 2024-12-31
BINANCE_START_DATE=2021-01-01
BINANCE_END_DATE=2025-12-31

# -------------------- INDICATOR PARAMETERS --------------------
EMA12_LEN=12
EMA144_LEN=144
EMA169_LEN=169
EMA576_LEN=576
EMA676_LEN=676

ADX_PERIOD=14

# ADX Threshold - minimum ADX value to confirm trend exists
# < 20 = no trend, 20-25 = weak, 25-50 = moderate, 50+ = strong
ADX_THRESHOLD=28

# ADX Max Threshold - avoid entering when trend is overextended
# When ADX > this value, no new positions allowed (trend exhaustion)
ADX_MAX_THRESHOLD=55

# ADX Slope - require trend to be strengthening (slope > 0)
# true = only enter when ADX is rising (trend strengthening)
# false = enter regardless of slope direction
ADX_REQUIRE_SLOPE_UP=true

# -------------------- VOLUME FILTER --------------------
# Volume Spike Ratio - avoid entering during abnormal volume spikes
# If current volume > avgVolume * ratio, no entry (volatility too high)
VOLUME_SPIKE_RATIO=2.0

# Number of candles to calculate average volume
VOLUME_AVG_PERIOD=20

# -------------------- RISK MANAGEMENT --------------------
# Stop lookback period (number of candles to look back for stop loss)
# 136 candles on 5min = 11+ hours, 25 candles = ~2 hours
STOP_LOOKBACK=136

# Leverage multiplier for position sizing
LEVERAGE=100

# Fixed notional amount in USDT for each trade
FIXED_NOTIONAL_USDT=100

# Reward-to-Risk ratio for take profit calculation
REWARD_RATIO=2.0

# Minimum reward-to-risk ratio to accept
MIN_REWARD_RATIO=1.5

# -------------------- FEES --------------------
MAKER_FEE_PERCENT=0.02
TAKER_FEE_PERCENT=0.075

# -------------------- LONG ENTRY RULES --------------------
# Strategy: Reversal with trend confirmation
# R1: Primary entry - 1st bounce from major support
LONG_RULE_1_ENABLE=true
# R2: 2nd bounce from major support
LONG_RULE_2_ENABLE=false
# R3: Mid EMA bounce with 2B pattern (confirmation)
LONG_RULE_3_ENABLE=true
# R4: 2nd mid EMA touch without pattern
LONG_RULE_4_ENABLE=false
# R5: Pullback recross (trend continuation)
LONG_RULE_5_ENABLE=true
# R6: Counter-trend double bottom (risky)
LONG_RULE_6_ENABLE=false
# R7: Trend filter (only enter when EMA144 > EMA169)
LONG_RULE_7_ENABLE=true
# R8: Complex counter-trend setup
LONG_RULE_8_ENABLE=true

# -------------------- SHORT ENTRY RULES --------------------
# Mirror of long rules
SHORT_RULE_1_ENABLE=false
SHORT_RULE_2_ENABLE=true
SHORT_RULE_3_ENABLE=true
SHORT_RULE_4_ENABLE=false
SHORT_RULE_5_ENABLE=true
SHORT_RULE_6_ENABLE=false
SHORT_RULE_7_ENABLE=false
SHORT_RULE_8_ENABLE=true

# -------------------- PATTERN DETECTION --------------------
# Number of candles to look back for 2B pattern detection
PATTERN_2B_LOOKBACK=30

# Number of candles to look back for double top/bottom pattern detection
PATTERN_DOUBLE_LOOKBACK=30

# -------------------- TIME FILTER SETTINGS --------------------
# Blocked hours (UTC) - comma separated, e.g. 8,14,19
# Based on analysis: These specific hours have 100% or very high loss rates
# 08:00, 14:00 = 100% loss; 21:00 = 88-100% loss
BLOCKED_HOURS= 15, 17

# Blocked days of week - comma separated (1=Monday, 7=Sunday)
# Based on analysis: Sunday (85%) and Saturday (88.9%) have highest loss rates
BLOCKED_DAYS=
# -------------------- MARKET REGIME SETTINGS --------------------
# Enable market regime detection (trend vs ranging)
ENABLE_MARKET_REGIME_FILTER=true

# Pause trading during high volatility ranging (choppy) markets
PAUSE_ON_HIGH_VOLATILITY_RANGE=true

# ADX thresholds for regime classification
# Strong trend: ADX >= 40 (aggressive R:R)
# Moderate trend: ADX 25-40 (moderate R:R)
# Ranging: ADX < 25 (conservative R:R or pause)
ADX_STRONG_TREND_THRESHOLD=
ADX_MODERATE_TREND_THRESHOLD=

# -------------------- DYNAMIC REWARD RATIO --------------------
# Enable dynamic R:R based on market regime
ENABLE_DYNAMIC_REWARD_RATIO=true

# R:R ratios for each regime
STRONG_TREND_REWARD_RATIO=3.8
MODERATE_TREND_REWARD_RATIO=2.0
RANGING_REWARD_RATIO=1.5

# -------------------- FIXED RISK POSITION SIZING --------------------
# Enable fixed risk per trade (instead of fixed notional)
# When enabled: quantity = fixedRisk / riskDistance
# This ensures each losing trade loses exactly FIXED_RISK_PER_TRADE_USDT
ENABLE_FIXED_RISK_SIZING=true

# Fixed risk amount in USDT per trade
# Example: If set to 100, each stopped-out trade loses ~100 USDT
FIXED_RISK_PER_TRADE_USDT=100

# -------------------- MAX HOLDING TIME --------------------
# Enable maximum position holding time limit
# Exits positions that exceed the time limit (reduces risk of prolonged drawdowns)
ENABLE_MAX_HOLDING_TIME=false

# Maximum hours to hold a position (336 = 2 weeks)
MAX_HOLDING_TIME_HOURS=450
# -------------------- REPORT SETTINGS --------------------
AUTO_OPEN_REPORTS=true
